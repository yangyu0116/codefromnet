<script language='javascript'>
linkarr = new Array();
picarr = new Array();
textarr = new Array();
var focus_width=218;　////幻灯片图片宽度，自己设置
var focus_height=152;　////幻杰片图片高度，自己设置
var text_height=0;　////如果想在幻灯片下方显示图片新闻标题，请将height值设为25或其它您认为合适的高度
var pics = "";
var links = "";
var texts = "";
var swf_height = focus_height+text_height;
////以下为幻灯显示内容的读取，可控制。
{dede:arclist type='image'}　////柏拉图提供的该代码是将整站所有图片都幻灯显示出来，显然不必要，反而增加首页显示负担，而且可显的图片超过一定数目时（我测试是超过9张图片时），下方的选择数字不能正常显示。可改为{dede:arclist type='image' titlelen='44' row='5' col='1'}，即只显示5张图片，图片标题宽度为44字符，你可参照DEDECMS的模板标记，实施其它控制。
linkarr[[field:global name=autoindex/]] = "[field:arcurl/]";
picarr[[field:global name=autoindex/]] = "[field:picname/]";
textarr[[field:global name=autoindex/]] = "[field:title/]";
{/dede:arclist}

for(i=0;i<picarr.length;i++)
{
if(pics=="") pics = picarr;
else pics += "|"+picarr;
}
for(i=0;i<linkarr.length;i++)
{
if(links=="") links = linkarr;
else links += "|"+linkarr;
}
for(i=0;i<textarr.length;i++)
{
if(texts=="") texts = textarr;
else texts += "|"+textarr;
}
document.write('<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" width="'+ focus_width +'" height="'+ swf_height +'">');
document.write('<param name="allowScriptAccess" value="sameDomain"><param name="movie" value="{dede:global name='cfg_plus_dir'/}/img/slide.swf">');
document.write('<param name="quality" value="high"><param name="bgcolor" value="#ffffff">');
document.write('<param name="menu" value="false"><param name=wmode value="opaque">');
document.write('<param name="FlashVars" value="pics='+pics+'&links='+links+'&texts='+texts+'&borderwidth='+focus_width+'&borderheight='+focus_height+'&textheight='+text_height+'">');
document.write('<embed src="{dede:global name='cfg_plus_dir'/}/img/slide.swf" wmode="opaque" FlashVars="pics='+pics+'&links='+links+'&texts='+texts+'&borderwidth='+focus_width+'&borderheight='+focus_height+'&textheight='+text_height+'" menu="false" bgcolor="#ffffff" quality="high" width="'+ focus_width +'" height="'+ focus_height +'" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />');
document.write('</object>');
</script>
